{% extends "group/read_base_primary.html" %}

{% block subtitle %}{{ c.group_dict.display_name }} - {{ _('Thematic Areas') }}{% endblock %}

{% block breadcrumb_content %}
  <li>{% link_for _('Thematic Areas'), controller='group', action='index' %}</li>
  <li class="active">{% link_for c.group_dict.display_name|truncate(35), controller='group', action='read', id=c.group_dict.name %}</li>
{% endblock %}

{% block content_action %}
{% if h.check_access('group_update', {'id': c.group_dict.id}) %}
{% link_for _('Manage'), controller='group', action='edit', id=c.group_dict.name, class_='btn btn-default btn-right', style='float:right', icon='wrench' %}
{% endif %}
{% endblock %}

{% block pre_primary %}
  {% if group.groups|length > 0 %}
    <div class="container single-column group-org-header" xmlns="http://www.w3.org/1999/html">

    {% block package_description %}
      <div class="dataset-detail-org-logo">
        <div class="image">
          <a href="{{ group_url }}">
            <img src="{{ c.group_dict.image_display_url or c.group_dict.image_url or h.url_for_static('/public/logo.jpg') }}" height= "100" width="100" alt="{{ name }}" />
          </a>
        </div>
      </div>

      <h1 class="dataset-detail-title">
          {% block page_heading %}
          {{ c.group_dict.title }}
        {% endblock %}
      </h1>

      {% block package_notes %}
        {% if c.group_dict.description %}
          <div class="notes embedded-content dataset-notes">
            {{ h.render_markdown(_(c.group_dict.description)) }}
          </div>
        {% endif %}
      {% endblock %}
    {% endblock %}

    {% if c.group_dict.name == 'agriculture_monitoring' %}
      <p>Download metadata file:
        <a href="/agriculture_monitoring.xml" download>
          <button type="button" class="btn btn-default btn-sm">
          <span class="fa fa-cloud-download"></span>
          ISO19139
          </button>
        </a>
      </p>
    {% endif %}

    {% if c.group_dict.name == 'biodiversity17' %}
      <p>Download metadata file:
        <a href="/biodiversity.xml" download>
          <button type="button" class="btn btn-default btn-sm">
          <span class="fa fa-cloud-download"></span>
          ISO19139
          </button>
        </a>
      </p>
    {% endif %}

    {% if c.group_dict.name == 'coastal' %}
      <p>Download metadata file:
        <a href="/CoReSyF.xml" download>
          <button type="button" class="btn btn-default btn-sm">
          <span class="fa fa-cloud-download"></span>
          ISO19139
          </button>
        </a>
      </p>
    {% endif %}

    {% if c.group_dict.name == 'disaster_risk_reduction' %}
      <p>Download metadata file:
        <a href="/disaster.xml" download>
          <button type="button" class="btn btn-default btn-sm">
          <span class="fa fa-cloud-download"></span>
          ISO19139
          </button>
        </a>
      </p>
    {% endif %}

    {% if c.group_dict.name == 'space-and-security' %}
      <p>Download metadata file:
        <a href="/satcen.xml" download>
          <button type="button" class="btn btn-default btn-sm">
          <span class="fa fa-cloud-download"></span>
          ISO19139
          </button>
        </a>
      </p>
    {% endif %}

    {% if c.group_dict.name == 'energy' %}
      <p>Download metadata file:
        <a href="/armines.xml" download>
          <button type="button" class="btn btn-default btn-sm">
          <span class="fa fa-cloud-download"></span>
          ISO19139
          </button>
        </a>
      </p>
    {% endif %}

    {% if c.group_dict.name == 'energy-1' %}
      <p>Download metadata file:
        <a href="/energy-pilot-1.xml" download>
          <button type="button" class="btn btn-default btn-sm">
          <span class="fa fa-cloud-download"></span>
          ISO19139
          </button>
        </a>
      </p>
    {% endif %}

    {% if c.group_dict.name == 'geocradle' %}
      <p>Download metadata file:
        <a href="/geo_cradle.xml" download>
          <button type="button" class="btn btn-default btn-sm">
          <span class="fa fa-cloud-download"></span>
          ISO19139
          </button>
        </a>
      </p>
    {% endif %}
  </div>
  {% else %}
      {% snippet 'group/snippets/group_parent.html', group = c.group_dict, name=c.group_dict.name %}
  {% endif %}
{% endblock %}

{% block content_primary_nav %}
  {% if c.group_dict.groups|length > 0 %}
    {{ h.build_nav_icon('topic_about', _('Metadata'), id=c.group_dict.name) }}

    {% set collection_count = h.get_topic_collections(c.group_dict['name'])|length %}
    {% if h.is_internal(group) %}
      {{ h.build_nav_icon('topic_read', _('Data Collections'), id=c.group_dict.name) }}
    {% endif %}
    {% if h.is_external(group) and collection_count > 0 %}
      {{ h.build_nav_icon('topic_read', _('Data Collections'), id=c.group_dict.name) }}
    {% endif %}

    {% set output_datasets = h.get_output_datasets(group) %}
    {% if h.is_internal(group) %}
      {{ h.build_nav_icon('topic_output', _('Output data'), id=c.group_dict.name) }}
    {% endif %}
    {% if h.is_external(group) and output_datasets|length > 0 %}
      {{ h.build_nav_icon('topic_output', _('Output data'), id=c.group_dict.name) }}
    {% endif %}
    {# Activity section available only for users that can create #}
    {% if h.check_access('package_create', {'owner_org': c.group_dict.id}) %}
      {{ h.build_nav_icon('topic_activity', _('Activity Stream'), id=c.group_dict.name, offset=0) }}
    {% endif %}
  {% endif %}
{% endblock %}